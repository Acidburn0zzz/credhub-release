---
name: credhub
templates:
  ctl: bin/ctl
  install_crt.sh: bin/install_crt.sh
  application.properties.erb: config/application.properties
  pre-start.erb: bin/pre-start
  post-start.erb: bin/post-start
  Chrystoki.conf.erb: config/Chrystoki.conf

packages:
- openjdk_1.8.0
- lunaclient
- credhub

properties:
  credhub.port:
    description: "Port for the CredHub server to listen on"
    default: 8844

  # HSM properties
  credhub.hsm.host:
    description: "The IP address of the HSM"
  credhub.hsm.port:
    description: "The HSM port"
    default: 1792
  credhub.hsm.certificate:
    description: "The HSMs certificate"
  credhub.hsm.partition:
    description: "Name of the HSM partition"
  credhub.hsm.partition_password:
    description: "Password for the HSM partition"
  credhub.hsm.encryption_key_name:
    description: "The name of the key stored in HSM to be reference by CredHub server for encryption"
  credhub.hsm.client_certificate:
    description: "NTLS client certificate registered with HSM"
  credhub.hsm.client_key:
    description: "NTLS client private key matching the client_certificate"

  # TLS configuration for the server
  credhub.tls.certificate:
    description: "TLS certificate"
  credhub.tls.private_key:
    description: "TLS private key for given certificate"

  # Data storage
  credhub.data_storage.type:
    description: "Database type, either in-memory (development only), mysql, or postgres, and there is no default"
  credhub.data_storage.username:
    description: "User name for credhub's database access"
  credhub.data_storage.password:
    description: "Password for credhub's database access"
  credhub.data_storage.host:
    description: "Host for credhub's database access"
  credhub.data_storage.port:
    description: "Port for credhub's database access"
  credhub.data_storage.database:
    description: "Name of database"
    default: "credhub"
  credhub.data_storage.require_tls:
    description: "If true, forbid insecure connections to MySQL. Does not apply to Postgres."
    default: true
  credhub.data_storage.tls_ca:
    description: "Certificate that database must supply when validation is required."

  # UAA
  credhub.user_management.uaa.url:
    description: "URL of UAA instance for client to contact"
  credhub.user_management.uaa.verification_key:
    description: "The public key for verifying tokens issued by the UAA instance"